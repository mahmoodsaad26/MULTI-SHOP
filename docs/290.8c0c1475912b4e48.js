"use strict";(self.webpackChunkmulti_shop=self.webpackChunkmulti_shop||[]).push([[290],{5290:(g,d,i)=>{i.r(d),i.d(d,{CartComponent:()=>A});var l=i(6814),p=i(1120),t=i(4769),h=i(6286),u=i(2425);function b(c,C){if(1&c){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12),t._UZ(2,"img",13),t.qZA(),t.TgZ(3,"div",14)(4,"div")(5,"h3",15),t._uU(6),t.qZA(),t.TgZ(7,"p",16),t._uU(8,"Price: "),t.TgZ(9,"span",7),t._uU(10),t.ALo(11,"currency"),t.qZA()(),t.TgZ(12,"button",17,18),t.NdJ("click",function(){const o=t.CHM(e).$implicit,a=t.MAs(13),m=t.oxw(2);return t.KtG(m.removeItem(o.product._id,a))}),t._UZ(14,"i",19),t._uU(15," remove "),t.qZA()(),t.TgZ(16,"div")(17,"button",20,21),t.NdJ("click",function(){const o=t.CHM(e).$implicit,a=t.MAs(18),m=t.MAs(23),v=t.oxw(2);return t.KtG(v.updateCount(o.product._id,o.count-1,a,m))}),t._uU(19,"-"),t.qZA(),t.TgZ(20,"span",22),t._uU(21),t.qZA(),t.TgZ(22,"button",20,23),t.NdJ("click",function(){const o=t.CHM(e).$implicit,a=t.MAs(18),m=t.MAs(23),v=t.oxw(2);return t.KtG(v.updateCount(o.product._id,o.count+1,a,m))}),t._uU(24,"+"),t.qZA()()()()}if(2&c){const e=C.$implicit;t.xp6(2),t.Q6J("src",e.product.imageCover,t.LSH)("alt",e.product.title),t.xp6(4),t.Oqu(e.product.title),t.xp6(4),t.Oqu(t.xi3(11,5,e.price,"EGP ")),t.xp6(11),t.Oqu(e.count)}}const n=function(c){return["/checkout",c]};function _(c,C){if(1&c){const e=t.EpF();t.TgZ(0,"section",2)(1,"div",3)(2,"h1",4),t._uU(3,"Shop Cart"),t.qZA(),t.TgZ(4,"button",5,6),t.NdJ("click",function(){t.CHM(e);const s=t.MAs(5),o=t.oxw();return t.KtG(o.clearAll(s))}),t._uU(6,"Clear All"),t.qZA()(),t.TgZ(7,"p"),t._uU(8,"total price: "),t.TgZ(9,"span",7),t._uU(10),t.ALo(11,"currency"),t.qZA()(),t.YNc(12,b,25,8,"div",8),t.TgZ(13,"button",9),t._uU(14,"Proceed to Checkout "),t._UZ(15,"img",10),t.qZA()()}if(2&c){const e=t.oxw();t.xp6(10),t.Oqu(t.xi3(11,3,null==e.cart||null==e.cart.data?null:e.cart.data.totalCartPrice,"EGP ")),t.xp6(2),t.Q6J("ngForOf",null==e.cart||null==e.cart.data?null:e.cart.data.products),t.xp6(1),t.Q6J("routerLink",t.VKq(6,n,null==e.cart||null==e.cart.data?null:e.cart.data._id))}}function f(c,C){1&c&&(t.TgZ(0,"h1",24),t._uU(1," Your cart is empty!"),t.qZA())}let A=(()=>{class c{constructor(e,r,s){this._CartService=e,this._Renderer2=r,this._ToastrService=s,this.cart=null,this.hasItems=!1}ngOnInit(){this._CartService.getCartItems().subscribe({next:e=>{e.numOfCartItems>0&&(this.cart=e,console.log(this.cart),this.hasItems=!0)}})}removeItem(e,r){this._Renderer2.setAttribute(r,"disabled","true"),this._CartService.removeCartItem(e).subscribe({next:s=>{this._Renderer2.removeAttribute(r,"disabled"),this._CartService.cartItemsCount.next(s.numOfCartItems),s.numOfCartItems>0?(this.cart=s,this.hasItems=!0):this.hasItems=!1},error:s=>{this._Renderer2.removeAttribute(r,"disabled")}})}updateCount(e,r,s,o){r>0&&(this._Renderer2.setAttribute(s,"disabled","true"),this._Renderer2.setAttribute(o,"disabled","true"),this._CartService.updateCartCoun(e,r).subscribe({next:a=>{this.cart=a,this._Renderer2.removeAttribute(s,"disabled"),this._Renderer2.removeAttribute(o,"disabled"),console.log(a)},error:a=>{this._Renderer2.removeAttribute(s,"disabled"),this._Renderer2.removeAttribute(o,"disabled")}}))}clearAll(e){this._Renderer2.setAttribute(e,"disabled","true"),this._CartService.clearCart().subscribe({next:r=>{console.log(r),"success"===r.message&&(this.hasItems=!1,this._ToastrService.error("you cleared your cart"),this._CartService.cartItemsCount.next(0))}})}static#t=this.\u0275fac=function(r){return new(r||c)(t.Y36(h.N),t.Y36(t.Qsj),t.Y36(u._W))};static#e=this.\u0275cmp=t.Xpm({type:c,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:3,vars:2,consts:[["class","w-75 mx-auto my-4 shadow rounded p-3 ",4,"ngIf","ngIfElse"],["empty",""],[1,"w-75","mx-auto","my-4","shadow","rounded","p-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"h2"],[1,"btn","btn-sm","btn-danger",3,"click"],["clearBtn",""],[1,"category-color"],["class","row border-bottom py-2",4,"ngFor","ngForOf"],[1,"main-btn","d-block","ms-auto","mt-3","py-0",3,"routerLink"],["src","./assets/assets/images/visa-1.svg","alt","visa logo"],[1,"row","border-bottom","py-2"],[1,"col-md-1"],[1,"w-100",3,"src","alt"],[1,"col-md-11","d-flex","justify-content-between","align-items-center"],[1,"h6"],[1,"mb-0"],[1,"btn","text-danger","p-0",3,"click"],["removeBtn",""],[1,"fa","fa-trash"],[1,"main-btn","btn-sm",3,"click"],["contdDecrease",""],[1,"px-2"],["contdIncrease",""],[1,"text-center","m-5"]],template:function(r,s){if(1&r&&(t.YNc(0,_,16,8,"section",0),t.YNc(1,f,2,0,"ng-template",null,1,t.W1O)),2&r){const o=t.MAs(2);t.Q6J("ngIf",s.hasItems)("ngIfElse",o)}},dependencies:[l.ez,l.sg,l.O5,l.H9,p.rH]})}return c})()},6286:(g,d,i)=>{i.d(d,{N:()=>h});var l=i(5619),p=i(4769),t=i(9862);let h=(()=>{class u{constructor(n){this._HttpClient=n,this.cartItemsCount=new l.X(0),this.myToken={token:localStorage.getItem("etoken")}}addToCart(n){return this._HttpClient.post("https://ecommerce.routemisr.com/api/v1/cart",{productId:n})}getCartItems(){return this._HttpClient.get("https://ecommerce.routemisr.com/api/v1/cart")}removeCartItem(n){return this._HttpClient.delete(`https://ecommerce.routemisr.com/api/v1/cart/${n}`)}updateCartCoun(n,_){return this._HttpClient.put(`https://ecommerce.routemisr.com/api/v1/cart/${n}`,{count:_})}clearCart(){return this._HttpClient.delete("https://ecommerce.routemisr.com/api/v1/cart")}checkout(n,_){return this._HttpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${n}?url=https://mahmoodsaad26.github.io/MULTI-SHOP`,{shippingAddress:_})}getAllOrders(n){return this._HttpClient.get(`https://ecommerce.routemisr.com/api/v1/orders/user/${n}`)}static#t=this.\u0275fac=function(_){return new(_||u)(p.LFG(t.eN))};static#e=this.\u0275prov=p.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);