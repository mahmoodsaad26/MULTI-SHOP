"use strict";(self.webpackChunkmulti_shop=self.webpackChunkmulti_shop||[]).push([[66],{6066:(N,l,a)=>{a.r(l),a.d(l,{ForgetPasswordComponent:()=>F});var d=a(6814),r=a(95),e=a(4769),c=a(9862);let u=(()=>{class s{constructor(t){this._HttpClient=t}forgotPassword(t){return this._HttpClient.post("https://ecommerce.routemisr.com/api/v1/auth/forgotPasswords",t)}verifyResetCode(t){return this._HttpClient.post("https://ecommerce.routemisr.com/api/v1/auth/verifyResetCode",t)}resetNewPass(t){return this._HttpClient.put("https://ecommerce.routemisr.com/api/v1/auth/resetPassword",t)}static#e=this.\u0275fac=function(o){return new(o||s)(e.LFG(c.eN))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var m=a(2425),p=a(1120);function _(s,i){1&s&&(e.TgZ(0,"p",9),e._uU(1,"Email is required"),e.qZA())}function g(s,i){1&s&&(e.TgZ(0,"p",9),e._uU(1,"Invalid Email"),e.qZA())}function f(s,i){if(1&s&&(e.TgZ(0,"div",7),e.YNc(1,_,2,0,"p",8),e.YNc(2,g,2,0,"p",8),e.qZA()),2&s){const t=e.oxw(2);let o,n;e.xp6(1),e.Q6J("ngIf",null==(o=t.sendCode.get("email"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(n=t.sendCode.get("email"))?null:n.getError("email"))}}function w(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.handleSendCode())}),e.TgZ(2,"label",3),e._uU(3,"Email:"),e.qZA(),e._UZ(4,"input",4),e.TgZ(5,"button",5),e._uU(6,"Send Code"),e.qZA(),e.YNc(7,f,3,2,"div",6),e.qZA()()}if(2&s){const t=e.oxw();let o;e.xp6(1),e.Q6J("formGroup",t.sendCode),e.xp6(6),e.Q6J("ngIf",(null==(o=t.sendCode.get("email"))?null:o.touched)&&(null==(o=t.sendCode.get("email"))?null:o.errors))}}function h(s,i){1&s&&(e.TgZ(0,"p",9),e._uU(1,"Reset Code is required"),e.qZA())}function C(s,i){if(1&s&&(e.TgZ(0,"div",7),e.YNc(1,h,2,0,"p",8),e.qZA()),2&s){const t=e.oxw(2);let o;e.xp6(1),e.Q6J("ngIf",null==(o=t.verifyCode.get("resetCode"))?null:o.getError("required"))}}function v(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.handleVerifyCode())}),e.TgZ(2,"label",10),e._uU(3,"Enter Reset Code:"),e.qZA(),e._UZ(4,"input",11),e.TgZ(5,"button",5),e._uU(6,"Verifya Code"),e.qZA(),e.YNc(7,C,2,1,"div",6),e.qZA()()}if(2&s){const t=e.oxw();let o;e.xp6(1),e.Q6J("formGroup",t.verifyCode),e.xp6(6),e.Q6J("ngIf",(null==(o=t.verifyCode.get("resetCode"))?null:o.touched)&&(null==(o=t.verifyCode.get("resetCode"))?null:o.errors))}}function x(s,i){1&s&&(e.TgZ(0,"p",9),e._uU(1,"New password is required"),e.qZA())}function P(s,i){1&s&&(e.TgZ(0,"p",9),e._uU(1,"must be at least 6 chars"),e.qZA())}function T(s,i){if(1&s&&(e.TgZ(0,"div",7),e.YNc(1,x,2,0,"p",8),e.YNc(2,P,2,0,"p",8),e.qZA()),2&s){const t=e.oxw(2);let o,n;e.xp6(1),e.Q6J("ngIf",null==(o=t.newPass.get("newPassword"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(n=t.newPass.get("newPassword"))?null:n.getError("pattern"))}}function Z(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"section",1)(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.handleNewPassword())}),e.TgZ(2,"label",10),e._uU(3,"Enter New Password:"),e.qZA(),e._UZ(4,"input",12),e.TgZ(5,"button",5),e._uU(6,"Reset Password"),e.qZA(),e.YNc(7,T,3,2,"div",6),e.qZA()()}if(2&s){const t=e.oxw();let o;e.xp6(1),e.Q6J("formGroup",t.newPass),e.xp6(6),e.Q6J("ngIf",(null==(o=t.newPass.get("newPassword"))?null:o.touched)&&(null==(o=t.newPass.get("newPassword"))?null:o.errors))}}let F=(()=>{class s{constructor(t,o,n){this._ForgetPasswordService=t,this._ToastrService=o,this._Router=n,this.step1=!0,this.step2=!1,this.step3=!1,this.userEmail="",this.sendCode=new r.cw({email:new r.NI("",[r.kI.required,r.kI.email])}),this.verifyCode=new r.cw({resetCode:new r.NI("",[r.kI.required])}),this.newPass=new r.cw({newPassword:new r.NI("",[r.kI.required,r.kI.pattern(/^\w{6,}$/)])})}handleSendCode(){console.log(this.sendCode),this.sendCode.valid&&this._ForgetPasswordService.forgotPassword(this.sendCode.value).subscribe({next:t=>{this._ToastrService.success(t.message),this.userEmail=this.sendCode.get("email")?.value,this.step1=!1,this.step2=!0},error:t=>{this._ToastrService.error(t.error.message)}})}handleVerifyCode(){this.verifyCode.valid&&this._ForgetPasswordService.verifyResetCode(this.verifyCode.value).subscribe({next:t=>{console.log(t),this._ToastrService.success(t.status),this.step2=!1,this.step3=!0},error:t=>{this._ToastrService.error(t.error.message)}})}handleNewPassword(){let t=this.newPass.value;t.email=this.userEmail,this._ForgetPasswordService.resetNewPass(t).subscribe({next:o=>{o.token&&(localStorage.setItem("eroken",o.token),this._Router.navigate(["/home"]))},error:o=>{this._ToastrService.error(o.error.message)}})}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(u),e.Y36(m._W),e.Y36(p.F0))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-forget-password"]],standalone:!0,features:[e.jDz],decls:3,vars:3,consts:[["class","w-75 mx-auto mt-5 shadow light-bg rounded-2 p-2 text-white",4,"ngIf"],[1,"w-75","mx-auto","mt-5","shadow","light-bg","rounded-2","p-2","text-white"],[3,"formGroup","ngSubmit"],["for","email"],["formControlName","email","type","email","id","email",1,"form-control"],[1,"main-btn","mt-2","w-100"],["class","alert alert-danger my-1",4,"ngIf"],[1,"alert","alert-danger","my-1"],["class","m-0",4,"ngIf"],[1,"m-0"],["for","code"],["formControlName","resetCode","type","text","id","code",1,"form-control"],["formControlName","newPassword","type","password","id","code",1,"form-control"]],template:function(o,n){1&o&&(e.YNc(0,w,8,2,"section",0),e.YNc(1,v,8,2,"section",0),e.YNc(2,Z,8,2,"section",0)),2&o&&(e.Q6J("ngIf",n.step1),e.xp6(1),e.Q6J("ngIf",n.step2),e.xp6(1),e.Q6J("ngIf",n.step3))},dependencies:[d.ez,d.O5,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u]})}return s})()}}]);